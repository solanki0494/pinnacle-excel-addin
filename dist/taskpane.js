(()=>{"use strict";var o={684:(o,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.copyOperatingExpenses=async function(o){try{console.log("Starting template copy from Outputs to Software Engineer Cash Flow...");const t=o.workbook.worksheets;if(t.load("items/name"),await o.sync(),console.log("Available sheets:",t.items.map(o=>o.name)),!t.items.some(o=>"Outputs"===o.name))throw new Error("The 'Outputs' sheet was not found. Please make sure the sheet exists and is named exactly 'Outputs'.");const e=o.workbook.worksheets.getItem("Outputs");let n,a=!1;if(t.items.some(o=>"Software Engineer Cash Flow"===o.name)?(n=o.workbook.worksheets.getItem("Software Engineer Cash Flow"),a=!0,console.log("Software Engineer Cash Flow sheet exists, will clear and override")):(console.log("Creating new Software Engineer Cash Flow sheet"),n=o.workbook.worksheets.add("Software Engineer Cash Flow"),a=!1),await o.sync(),a){const t=n.getUsedRange();t&&(t.clear(),await o.sync(),console.log("Cleared existing content from Software Engineer Cash Flow sheet"))}const r=e.getUsedRange();if(!r)throw new Error("The 'Outputs' sheet appears to be empty. Please add some content to copy.");r.load(["values","formulas","format","rowCount","columnCount"]),await o.sync(),console.log(`Template range size: ${r.rowCount} rows x ${r.columnCount} columns`);const s=n.getRangeByIndexes(0,0,r.rowCount,r.columnCount);try{await async function(o,t,e){try{o.format.load(["columnWidth","rowHeight","horizontalAlignment","verticalAlignment","wrapText","textOrientation","shrinkToFit","readingOrder","borders","fill","font","protection"]),await e.sync(),t.format.horizontalAlignment=o.format.horizontalAlignment,t.format.verticalAlignment=o.format.verticalAlignment,t.format.wrapText=o.format.wrapText,t.format.textOrientation=o.format.textOrientation,t.format.shrinkToFit=o.format.shrinkToFit,t.format.readingOrder=o.format.readingOrder,o.format.font.load(["name","size","bold","italic","underline","color"]),await e.sync(),t.format.font.name=o.format.font.name,t.format.font.size=o.format.font.size,t.format.font.bold=o.format.font.bold,t.format.font.italic=o.format.font.italic,t.format.font.underline=o.format.font.underline,t.format.font.color=o.format.font.color,o.format.fill.load(["color","pattern"]),await e.sync(),t.format.fill.color=o.format.fill.color,t.format.fill.pattern=o.format.fill.pattern,await e.sync(),console.log("Formatting copied successfully")}catch(o){console.warn("Could not copy all formatting, continuing with values:",o)}}(r,s,o),s.values=r.values,await async function(o,t,e,n){try{for(let a=0;a<e.columnCount;a++){const e=o.getRange(`${String.fromCharCode(65+a)}:${String.fromCharCode(65+a)}`),r=t.getRange(`${String.fromCharCode(65+a)}:${String.fromCharCode(65+a)}`);e.format.load("columnWidth"),await n.sync(),r.format.columnWidth=e.format.columnWidth}for(let a=0;a<e.rowCount;a++){const e=o.getRange(`${a+1}:${a+1}`),r=t.getRange(`${a+1}:${a+1}`);e.format.load("rowHeight"),await n.sync(),r.format.rowHeight=e.format.rowHeight}await n.sync(),console.log("Column widths and row heights copied successfully")}catch(o){console.warn("Could not copy all dimensions, continuing:",o)}}(e,n,r,o),await o.sync()}catch(o){throw console.error("Error during range operations:",o),new Error(`Failed to copy data: ${o instanceof Error?o.message:String(o)}`)}console.log("Successfully copied template structure, formatting, and calculated values to Software Engineer Cash Flow sheet")}catch(o){throw console.error("Error copying template:",o),o instanceof Error?o.message.includes("doesn't exist")?new Error("Sheet not found. Please ensure both 'Outputs' sheet exists in your workbook."):o.message.includes("empty")?o:new Error(`Template copy failed: ${o.message}`):new Error("An unexpected error occurred while copying the template.")}},t.showNotification=async function(o,t){try{console.log(`${o}: ${t}`)}catch(e){console.log(`${o}: ${t}`)}}}},t={};function e(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return o[n](r,r.exports,e),r.exports}(()=>{const o=e(684);function t(){"undefined"!=typeof Office&&Office.onReady?Office.onReady(o=>{o.host===Office.HostType.Excel&&(console.log("Office.js and Excel are ready"),document.getElementById("runCalculation").onclick=n)}):(console.log("Office.js not ready, retrying..."),setTimeout(t,100))}async function n(){try{await Excel.run(async t=>{a("Running calculation...","info"),t.application.calculationMode=Excel.CalculationMode.automatic,t.application.calculate(Excel.CalculationType.full),await(0,o.copyOperatingExpenses)(t),a("Calculation completed successfully!","success")})}catch(o){console.error(o),a(`Error: ${o instanceof Error?o.message:String(o)}`,"error")}}function a(o,t){const e=document.getElementById("status");e.textContent=o,e.className=`status ${t}`,e.style.display="block","error"!==t&&setTimeout(()=>{e.style.display="none"},5e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})()})();