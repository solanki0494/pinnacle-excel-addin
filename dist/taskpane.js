(()=>{"use strict";var e={684:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.copyOperatingExpenses=async function(e){try{console.log("Starting template copy from Outputs to Software Engineer Cash Flow...");const o=e.workbook.worksheets;if(o.load("items/name"),await e.sync(),console.log("Available sheets:",o.items.map(e=>e.name)),!o.items.some(e=>"Outputs"===e.name))throw new Error("The 'Outputs' sheet was not found. Please make sure the sheet exists and is named exactly 'Outputs'.");const t=e.workbook.worksheets.getItem("Outputs"),s=o.items.some(e=>"Software Engineer Cash Flow"===e.name);let n=!1;s?(console.log("Software Engineer Cash Flow sheet exists, will be replaced with fresh copy"),n=!0):(console.log("Software Engineer Cash Flow sheet does not exist, will create fresh copy"),n=!1),console.log("Using sheet copy approach for perfect formatting preservation"),t.load("visibility"),await e.sync();const a=t.visibility===Excel.SheetVisibility.hidden;n&&(console.log("Deleting existing Software Engineer Cash Flow sheet"),e.workbook.worksheets.getItem("Software Engineer Cash Flow").delete(),await e.sync()),console.log(`Outputs sheet visibility: ${t.visibility} (hidden: ${a})`),console.log("Copying Outputs sheet...");const l=t.copy(Excel.WorksheetPositionType.after,t);l.name="Software Engineer Cash Flow",a&&(console.log("Source sheet was hidden, ensuring Software Engineer Cash Flow sheet is visible"),l.visibility=Excel.SheetVisibility.visible),await e.sync(),console.log("Sheet copied successfully, now converting formulas to values...");const i=l.getUsedRange();i?(i.load(["values","rowCount","columnCount"]),await e.sync(),console.log(`Converting formulas to values for range: ${i.rowCount} rows x ${i.columnCount} columns`),i.copyFrom(i,Excel.RangeCopyType.values,!1,!1),await e.sync(),console.log("Successfully converted all formulas to values")):console.warn("No used range found in copied sheet");const r=e.workbook.worksheets;if(r.load("items/name"),await e.sync(),!r.items.some(e=>"Software Engineer Cash Flow"===e.name))throw new Error("Software Engineer Cash Flow sheet was not found after copying - this should not happen");e.workbook.worksheets.getItem("Software Engineer Cash Flow").activate(),await e.sync(),console.log("✅ Successfully copied Outputs sheet to Software Engineer Cash Flow with perfect formatting"),console.log("✅ All formulas converted to calculated values"),console.log("✅ Colors, borders, fonts, and layout preserved exactly"),console.log("✅ Software Engineer Cash Flow sheet is now active and visible"),a&&console.log("✅ Source sheet was hidden, but result sheet is kept visible for user access")}catch(e){throw console.error("Error copying template:",e),e instanceof Error?e.message.includes("doesn't exist")?new Error("Sheet not found. Please ensure both 'Outputs' sheet exists in your workbook."):e.message.includes("empty")?e:new Error(`Template copy failed: ${e.message}`):new Error("An unexpected error occurred while copying the template.")}},o.showNotification=async function(e,o){try{console.log(`${e}: ${o}`)}catch(t){console.log(`${e}: ${o}`)}}}},o={};function t(s){var n=o[s];if(void 0!==n)return n.exports;var a=o[s]={exports:{}};return e[s](a,a.exports,t),a.exports}(()=>{const e=t(684);function o(){"undefined"!=typeof Office&&Office.onReady?Office.onReady(e=>{e.host===Office.HostType.Excel&&(console.log("Office.js and Excel are ready"),document.getElementById("runCalculation").onclick=s)}):(console.log("Office.js not ready, retrying..."),setTimeout(o,100))}async function s(){try{await Excel.run(async o=>{n("Running calculation...","info"),o.application.calculationMode=Excel.CalculationMode.automatic,o.application.calculate(Excel.CalculationType.full),await(0,e.copyOperatingExpenses)(o),n("Calculation completed successfully!","success")})}catch(e){console.error(e),n(`Error: ${e instanceof Error?e.message:String(e)}`,"error")}}function n(e,o){const t=document.getElementById("status");t.textContent=e,t.className=`status ${o}`,t.style.display="block","error"!==o&&setTimeout(()=>{t.style.display="none"},5e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()})()})();