(()=>{"use strict";var e={684:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.copyOperatingExpenses=async function(e){try{console.log("Starting template copy from Outputs to Software Engineer Cash Flow...");const o=e.workbook.worksheets;if(o.load("items/name"),await e.sync(),console.log("Available sheets:",o.items.map(e=>e.name)),!o.items.some(e=>"Outputs"===e.name))throw new Error("The 'Outputs' sheet was not found. Please make sure the sheet exists and is named exactly 'Outputs'.");const t=e.workbook.worksheets.getItem("Outputs");let n,r=!1;if(o.items.some(e=>"Software Engineer Cash Flow"===e.name))console.log("Software Engineer Cash Flow sheet exists, will clear and override"),n=e.workbook.worksheets.getItem("Software Engineer Cash Flow"),r=!0;else{console.log("Software Engineer Cash Flow sheet does not exist, creating new sheet");try{n=e.workbook.worksheets.add("Software Engineer Cash Flow"),r=!1,console.log("Successfully created Software Engineer Cash Flow sheet")}catch(e){throw console.error("Error creating sheet:",e),new Error(`Failed to create 'Software Engineer Cash Flow' sheet: ${e instanceof Error?e.message:String(e)}`)}}await e.sync();try{n.load("name"),await e.sync(),console.log(`Target sheet confirmed: ${n.name}`)}catch(e){throw console.error("Error verifying target sheet:",e),new Error("Failed to access the target sheet after creation/selection")}if(r)try{const o=n.getUsedRange();o&&(o.clear(),await e.sync(),console.log("Cleared existing content from Software Engineer Cash Flow sheet"))}catch(e){console.warn("Could not clear existing content (sheet might be empty):",e)}const a=t.getUsedRange();if(!a)throw new Error("The 'Outputs' sheet appears to be empty. Please add some content to copy.");a.load(["values","formulas","format","rowCount","columnCount"]),await e.sync(),console.log(`Template range size: ${a.rowCount} rows x ${a.columnCount} columns`);const s=n.getRangeByIndexes(0,0,a.rowCount,a.columnCount);try{await async function(e,o,t){try{e.format.load(["columnWidth","rowHeight","horizontalAlignment","verticalAlignment","wrapText","textOrientation","shrinkToFit","readingOrder","borders","fill","font","protection"]),await t.sync(),o.format.horizontalAlignment=e.format.horizontalAlignment,o.format.verticalAlignment=e.format.verticalAlignment,o.format.wrapText=e.format.wrapText,o.format.textOrientation=e.format.textOrientation,o.format.shrinkToFit=e.format.shrinkToFit,o.format.readingOrder=e.format.readingOrder,e.format.font.load(["name","size","bold","italic","underline","color"]),await t.sync(),o.format.font.name=e.format.font.name,o.format.font.size=e.format.font.size,o.format.font.bold=e.format.font.bold,o.format.font.italic=e.format.font.italic,o.format.font.underline=e.format.font.underline,o.format.font.color=e.format.font.color,e.format.fill.load(["color","pattern"]),await t.sync(),o.format.fill.color=e.format.fill.color,o.format.fill.pattern=e.format.fill.pattern,await t.sync(),console.log("Formatting copied successfully")}catch(e){console.warn("Could not copy all formatting, continuing with values:",e)}}(a,s,e),s.values=a.values,await async function(e,o,t,n){try{for(let r=0;r<t.columnCount;r++){const t=e.getRange(`${String.fromCharCode(65+r)}:${String.fromCharCode(65+r)}`),a=o.getRange(`${String.fromCharCode(65+r)}:${String.fromCharCode(65+r)}`);t.format.load("columnWidth"),await n.sync(),a.format.columnWidth=t.format.columnWidth}for(let r=0;r<t.rowCount;r++){const t=e.getRange(`${r+1}:${r+1}`),a=o.getRange(`${r+1}:${r+1}`);t.format.load("rowHeight"),await n.sync(),a.format.rowHeight=t.format.rowHeight}await n.sync(),console.log("Column widths and row heights copied successfully")}catch(e){console.warn("Could not copy all dimensions, continuing:",e)}}(t,n,a,e),await e.sync()}catch(e){throw console.error("Error during range operations:",e),new Error(`Failed to copy data: ${e instanceof Error?e.message:String(e)}`)}const i=e.workbook.worksheets;if(i.load("items/name"),await e.sync(),!i.items.some(e=>"Software Engineer Cash Flow"===e.name))throw new Error("Software Engineer Cash Flow sheet was not found after creation - this should not happen");console.log("Successfully copied template structure, formatting, and calculated values to Software Engineer Cash Flow sheet"),console.log("Final verification: Software Engineer Cash Flow sheet exists and contains data")}catch(e){throw console.error("Error copying template:",e),e instanceof Error?e.message.includes("doesn't exist")?new Error("Sheet not found. Please ensure both 'Outputs' sheet exists in your workbook."):e.message.includes("empty")?e:new Error(`Template copy failed: ${e.message}`):new Error("An unexpected error occurred while copying the template.")}},o.showNotification=async function(e,o){try{console.log(`${e}: ${o}`)}catch(t){console.log(`${e}: ${o}`)}}}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var a=o[n]={exports:{}};return e[n](a,a.exports,t),a.exports}(()=>{const e=t(684);function o(){"undefined"!=typeof Office&&Office.onReady?Office.onReady(e=>{e.host===Office.HostType.Excel&&(console.log("Office.js and Excel are ready"),document.getElementById("runCalculation").onclick=n)}):(console.log("Office.js not ready, retrying..."),setTimeout(o,100))}async function n(){try{await Excel.run(async o=>{r("Running calculation...","info"),o.application.calculationMode=Excel.CalculationMode.automatic,o.application.calculate(Excel.CalculationType.full),await(0,e.copyOperatingExpenses)(o),r("Calculation completed successfully!","success")})}catch(e){console.error(e),r(`Error: ${e instanceof Error?e.message:String(e)}`,"error")}}function r(e,o){const t=document.getElementById("status");t.textContent=e,t.className=`status ${o}`,t.style.display="block","error"!==o&&setTimeout(()=>{t.style.display="none"},5e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()})()})();